<!DOCTYPE html>
<html lang="zh_CN" xmlns:th="http://www.thymeleaf.org"
	xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<meta charset="utf-8">

<head th:include="include::formHeaderContent"></head>
<style>
	.li-ul{margin:0px;padding:0px;width:100%;}
	.c-text{color:#555;display:flex;align-items:center;}
	.select-box{width:100%;margin-top:4px;margin-bottom:5px;}
	.select-box .linked {
	    margin-left:10px;
	    padding-right:10px;
	}
	#selectAll{
		margin-left:7px;
		border-right:1px solid var(--gray-light);
	}
</style>

<body class="windowPage layer-body" th:classappend="${session.theme}">
	
	<div class="layer-box">
		<form action="" id="operate">
			<input type="hidden" id="isContinue" value=""/>
			<input type="hidden" id="id" name="id" th:value="${lifecyclePhase.id}"/>
			<input type="hidden" id="objectType" name="objectType" th:value="${lifecyclePhase.objectType}"/>
			<input type="hidden" id="lifecycleId" name="lifecycleId" th:value="${lifecycleId}"/>
			<div class="layout-box new">
				<div class="layout-left">
					<ul class="page-ul">
						<li class="field-li r content-whole sign" field="loginInfo" htype="SIGN">
							<div class="field-div field-sign-title3">
								<div class="title" th:text="基本信息"></div>
							</div>
							<div class="field-div field-sign-content"></div>
						</li>
						<li class="field-li r content-whole" field="phaseName" htype="TEXT" th:style="${isEdit} eq 'Y' ? 'display:flex' : 'display:none' ">
							<div class="field-div field-label"><span class="title" th:text="生命阶段"></span></div>
							<div class="field-div field-content" th:text="${phaseName}"></div>
						</li>
						<li class="field-li content-whole r odd" field="preName" htype="SELECT">
							<div class="field-div field-label"><span class="requireSign"></span><span class="title" th:text="前置阶段"></span></div>
							<div class="field-div field-content" th:text="${preName}"></div>
						</li>
						<li class="field-li check content-whole" field="status" htype="RADIO">
							<div class="field-div field-label"><span class="requireSign"></span><span class="title">设置权限</span></div>
							<div class="field-div field-content-check">
								<input type="hidden" id="fixTran" name="fixTran" th:value="${lifecyclePhase.fixTran}"/>
							    <div th:each="tran:${transitionList}" class="checkbox" style="width:30%">
							    	<input type="checkbox" name="tranId" th:id="${tran.id}" th:value="${tran.id}" th:checked="${tran.selected}" data-target="checkbox" disabled="disabled">
								    <label th:for="${tran.id}" th:text="${tran.name}" th:title="${tran.name}"></label>
								</div>
							</div>
						</li>
						<li class="field-li check content-whole odd" field="status" htype="RADIO">
							<div class="field-div field-label"><span class="requireSign"></span><span class="title">高级设置</span></div>
							<div class="field-div field-content-check">
							    <div class="checkbox" style="width:30%">
							    	<input type="checkbox" name="_isHide" th:id="_isHide" th:checked="${lifecyclePhase.isHide} eq 'Y'" data-target="checkbox"  disabled="disabled">
								    <label th:for="_isHide" th:title="隐藏对象">隐藏对象</label>
								</div>
							    <div class="checkbox" style="width:30%">
							    	<input type="checkbox" name="_closeRes" th:id="_closeRes" th:checked="${lifecyclePhase.closeRes} eq 'Y'" data-target="checkbox"  disabled="disabled">
								    <label th:for="_closeRes" th:title="关闭对象">关闭对象</label>
								</div>
							</div>
						</li>
					</ul>
					<div class="formBtn hide">
						<div class="layui-layer-btn layui-submit-btn">
							<input type="submit" id="submit" class="layui-layer-btn0 btns cp" th:value="编辑" onclick="editLifecyclePhase();"/>
							<a class="layui-layer-btn1 close-btn cp" th:text="#{common.cancel}" onclick="layerWinCancel($(this));"></a>
						</div>
					</div>
				</div>
			</div>
		</form>
	</div>
	
	<div th:include="include::formFooterContent"></div>
	<script th:inline="javascript"> var ctx = [[@{/}]]; parentName = [[${param.parentname}]]; </script>
	
	<script>
		$(function() {
			initFormControl('PHASE');
			$('.formBtn').removeClass('hide');
		});
		
		
		function editLifecyclePhase() {
			var url = '/lifecycle/addOrEditLifecyclePhase/'+$('#id').val()+'?lifecycleId='+$('#lifecycleId').val()+'&objectType='+$('#objectType').val()+'&preId=&&parentname='+parentName;
			parent.layer.open({
				skin: 'iframeClass',
				type : 2,
				title : '编辑生命阶段',
				maxmin : false,
				shadeClose : false, // 点击遮罩关闭层
				area : ['100%', '100%'],
				content : url,
				end: function(){
					var index = parent.layer.getFrameIndex(window.name)
					parent.layer.close(index, 'phase-table');
				}
			});
		}
	</script>
	
</body>
</html>
